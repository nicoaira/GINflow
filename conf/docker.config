// Docker profile configuration
profiles {
  docker {
    docker.enabled   = true
    process.executor = 'local'

    // Default container for ALL processes (CPU‚Äêonly)
    process.container = 'ginflow:0.1.0'

    // Process-specific settings
    process {
      withName: GENERATE_EMBEDDINGS {
        container = 'ginflow-gpu:0.1.0'
        
        // Simplified GPU access - just use --gpus all without runtime specification
        // This works on Docker installations with NVIDIA Container Toolkit
        docker.runOptions = '--gpus all'
        
        // Pass NVIDIA environment variables for GPU detection
        env.NVIDIA_VISIBLE_DEVICES = 'all'
        env.CUDA_VISIBLE_DEVICES = '0'
      }
    }

    // Disable trace/report in Docker profile
    trace.enabled    = false
    report.enabled   = false
    timeline.enabled = false
    dag.enabled      = false

    process.env.PATH = "/app/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
  }
}